filter {
    if [d] == true {
      # merge field into udmfield array
      mutate {
          merge => {
              "udmfield" => "field"
          }
          on_error => "zerror.mergeerrnum"
      }
    }
    else if [fieldname] == "value3" {
      # Set udmfield UDM Field1
      if [fieldname] == "value1" {
          mutate {
              replace => {
                  "event.idm.read_only_udm.udmfield"  => "%{elif1}"
              }
          }
      }
        mutate {
            replace => {
                "event.idm.read_only_udm.udmfield"  => "%{elif2}"
            }
        }
    }
    else {
      # merge field into udmfield array
      mutate {
          merge => {
              "udmfield" => "field"
          }
          on_error => "zerror.mergeerrnum"
      }
      for entry in ['df'] {
        # Rename field to udmfield
        mutate {
            rename => {
                "field" => "udmfield"
            }
            on_error => "zerror.rename.udmfield_exists"
        }
      }
    }
    # Replace udmfield with field
    mutate {
        replace => {
            "event.idm.read_only_udm.udmfield" => "%{field}"
        }
        on_error => "zerror.replace.field"
    }
}