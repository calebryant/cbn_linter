filter {
    if [event_json] != "" {
        if [event_json][src_port] != "" {
            mutate {
                replace => { 
                    "event_json.src_port" => "integer"
                }
                on_error => "zerror.src_port_is_int"
            }
        }
    }
    else if [event_json2] != "" {
        # fieldname LOOP
        if [fieldname] == "value" {
            for record in fieldname {
                mutate 
                    merge => {
                        "event.idm.read_only_udm.udmfield" => "record"
                        "event.idm.read_only_udm.udmfield" => "record"
                        "event.idm.read_only_udm.udmfield" => "record"
                        "event.idm.read_only_udm.udmfield" => "record"
                    }
                }
            }
        }
        # merge field into udmfield array
        mutate {
            merge => {
                "udmfield" => "field"
            }
            on_error => "zerror.mergeerrnum"
        }
    }
}