filter {
    if [event_json] != "" {
        if [event_json][src_port] != "" {
            mutate {
                replace =>  {
                    "event_json.src_port" => "integer"
                }
                on_error => "zerror.src_port_is_int"
            }
        }
        # GROK fieldname
        grok {
            match => {
                "log_data" => [
                    "^regex$"
                ]
            }
            overwrite => ["fieldname"]
            on_error => "zerror.grokerrornum"
        }
    }
    # fieldname LOOP
    if [fieldname] == "value" 
        for record in fieldname {
            mutate {
                merge => {
                    "event.idm.read_only_udm.udmfield" => "record"
                }
            }
        }
    }
    # merge field into udmfield array
    mutate {
        merge => {
            "udmfield" => "field"
        }
        on_error => "zerror.mergeerrnum"
    }
}