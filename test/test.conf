filter {
    if [fieldname] == "" {
        json {
            source => "field"
            array_function => "split_columns"
            target => "field"
            on_error => "zerror.jsonerrnum"
        }
        csv {
            source => "field"
            array_function => "split_columns"
            target => "field"
            on_error => "zerror.jsonerrnum"
        }
        # cef_data 
        mutate {
            gsub => [
                'fieldname','oldvalue','newvalue'
            ]
        }
        # Handle Key/Value data
        kv {
            source => "cef_data"
            field_split => "split"
            value_split => "="
            target => "kv"
            on_error => "zerror.kv00"
        }
        date {
            match => [ 
                "timestamp", 
                "yyyy-MM-dd HH:mm:ss",
                "yyyy-MM-d HH:mm:ss",
                "yyyy-M-dd HH:mm:ss",
                "yyyy-M-d HH:mm:ss",
            ]
            rebase => true
            on_error => "zerror.time00"
        }
        drop {
            tag => "BROKENLOG"
        }
    }
}